#2020
#Llamamos las funciones de metaexploit
#require 'msf/core'

#Iniciamos nuestra clase 
class MetasploitModule < Msf::Auxiliary
 ##Llamamos las funciones de ftp y de escaner
 include Msf:Exploit::Remote::Ftp 
 include Msf:Auxiliary::Scanner
 #Inicio de nuestro exploit
 def initialize
     # Colocamos datos que describan nuestro exploit 
     super(
     'Name'         => 'FTP Access'
     'Description'  => 'Detectamos que version de ftp tiene la maquina remota'
     'Author'       => 'Alex'
     'License'      => 'MSF_LICENSE'
     )
#Damos de alta los valores que vamos a recibir desde linea de comandos 
register_options([
     Opt:RPORT(21),
    ])
    end
    def run_host(host)
        # True habilita los parametros globales, flase=termina la conecion cuando encontrado
        connect(true,false)
        #Si connect se conecta retorna un valor en banner
        if (banner)
         #Imprime el valor de host y del banner
         print_good("Esta corriendo: #{rhost} -Banner: #{banner}")
        end
        disconnect
    end
end
